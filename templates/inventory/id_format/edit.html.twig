{% extends 'base.html.twig' %}

{% block title %}Custom ID format{% endblock %}

{% block body %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h3 class="mb-0">Custom ID format</h3>
      <div class="text-muted small">
        Inventory: <strong>{{ inventory.name }}</strong>
      </div>
    </div>

    <a href="{{ path('inventory_index') }}" class="btn btn-outline-secondary">Back</a>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">

      <form method="post" class="vstack gap-3">
        {#
        ВАЖНО:
        имена part_type[] param1[] param2[] должны совпадать с контроллером
        #}

        <div class="table-responsive">
          <table class="table align-middle">
            <thead class="table-light">
            <tr>
              <th style="width: 220px;">Part type</th>
              <th>Param 1</th>
              <th>Param 2</th>
            </tr>
            </thead>

            <tbody>
            {# существующие части #}
            {% for part in parts %}
              <tr>
                <td>
                  <select class="form-select" name="part_type[]">
                    <option value="">-- select --</option>
                    {% for t in partTypes %}
                      <option value="{{ t.value }}"
                              {% if part.type is defined and part.type == t.value %}selected{% endif %}
                        {% if part.type is not defined and part.type is same as(t) %}selected{% endif %}
                      >
                        {{ t.name }}
                      </option>
                    {% endfor %}
                  </select>
                </td>
                <td>
                  <input class="form-control" name="param1[]" value="{{ part.param1|default('') }}">
                </td>
                <td>
                  <input class="form-control" name="param2[]" value="{{ part.param2|default('') }}">
                </td>
              </tr>
            {% endfor %}

            {# + одна пустая строка, чтобы можно было быстро добавить новый part #}
            <tr>
              <td>
                <select class="form-select" name="part_type[]">
                  <option value="" selected>-- select --</option>
                  {% for t in partTypes %}
                    <option value="{{ t.value }}">{{ t.name }}</option>
                  {% endfor %}
                </select>
              </td>
              <td><input class="form-control" name="param1[]" value=""></td>
              <td><input class="form-control" name="param2[]" value=""></td>
            </tr>
            </tbody>
          </table>
        </div>

        <div class="d-flex gap-2">
          <button class="btn btn-primary" type="submit">Save</button>
          <a href="{{ path('inventory_index') }}" class="btn btn-outline-secondary">Cancel</a>
        </div>

        <div class="text-muted small">
          Tip: leave “Part type” empty to ignore that row.
        </div>
      </form>

    </div>
  </div>
{% endblock %}
